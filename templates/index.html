{% extends "base.html" %}
{% block content %}
<div class="bg-white border border-gray-200 shadow-md rounded-2xl p-8 space-y-6">
  <h2 class="text-2xl font-semibold text-gray-800">ðŸ“„ Excel Data Formatter</h2>

  <form method="POST" enctype="multipart/form-data" class="space-y-6">
    

    <!-- Exam Selection -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-700">Select Exam</label>
      <select name="exam" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-gray-800">
        <option value="PEP4">PEP4</option>
        <option value="PEP5">PEP5</option>
        <option value="PEP6" selected>PEP6</option>
      </select>
    </div>

    <!-- Mode Selection -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-700">Select Mode</label>
      <select name="mode" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-gray-800">
        <option value="register">Candidate Register</option>
        <option value="count">Candidate Register Count</option>
      </select>
    </div>

    <!-- Year Select-->
    <div id="period-input" style="display: none;">
      <label class="block mb-2 text-sm font-medium text-gray-700">Enter Period</label>
      <input type="number" name="period" min="2000" max="{{ current_year }}"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-gray-800"
            placeholder="e.g., 2025">
    </div>

    <!-- Input Specification -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-700">Input Specification</label>
      <input type="file" name="input_spec" accept=".xlsx"
             class="w-full file:bg-[#3a8cc7] file:text-white file:rounded-md file:px-4 file:py-2
                    text-sm border border-gray-300 rounded-lg cursor-pointer bg-white text-gray-800" required>
    </div>

    <!-- Data Workbook -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-700">Data Workbook</label>
      <input type="file" name="data_wb" accept=".xlsx"
             class="w-full file:bg-[#3a8cc7] file:text-white file:rounded-md file:px-4 file:py-2
                    text-sm border border-gray-300 rounded-lg cursor-pointer bg-white text-gray-800" required>
    </div>

    <!-- Button -->
    <div class="text-center">
      <button type="submit"
              class="bg-[#3a8cc7] hover:bg-blue-600 transition-all px-6 py-2 text-white font-medium rounded-xl shadow-md">
        Run Formatting & Download
      </button>
    </div>

  </form>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const modeSelect = document.querySelector('select[name="mode"]');
    const yearInputDiv = document.getElementById('period-input');

    function toggleYearInput() {
      yearInputDiv.style.display = (modeSelect.value === 'count') ? 'block' : 'none';
    }

    modeSelect.addEventListener('change', toggleYearInput);
    toggleYearInput(); // run on page load
  });
</script>
{% endblock %}
